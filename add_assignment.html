
<style>.ql-toolbar .ql-stroke {
  fill: none;
  stroke: #fff;
}

.ql-toolbar .ql-fill {
  fill: #fff;
  stroke: none;
}

.ql-toolbar .ql-picker {
  color: #fff;
}
</style>
  <div class="col-12">
    <form id="add_assignment_form">

        <div class="mb-3">
            <label for="sname" class="form-label">Assignment Name</label>
            <input type="text" name="name" class="form-control" id="aname">
          </div>
        <div class="mb-3">
          <label for="editor" class="form-label" >Question</label>
          <div name="question"  id="editor" cols="30" style="border-radius: 0px !important;" class="form-control"></div>
          <!-- <input type="email" name="email"> -->
        </div>
        <div class="mb-3">
          <label for="answer">Answer</label>
          <textarea type="text" name="answer" oninput="updateCodeHighlighting()" id="code-input" class="form-control" rows="5"></textarea>
        </div>
        <pre style="background-color: white !important;"><code class="language-java" id="prismcodehere1">
        </code></pre>
        <!-- <p id="code-temp"></p> -->
        <!-- <div id="code-temp"></div> -->
        <div class="mb-3">
            <label for="cid" class="form-label">Course</label>
            <select id="cid" class="form-control">
              <option selected>Select Course</option>
            </select>
          </div>
        <button type="submit" class="btn btn-primary">Add</button>
      </form>
 </div>
 



 <script>
   $.ajax({
        type: "get",
        contentType: "application/json",
        url: `${baseurl}/get-courses-whole-list`,
        success: function (result) {
          console.log(result)
          
          result.forEach(element => {
            document.getElementById("cid").innerHTML += `<option value="${element.id}">${element.cname}</option>`;
          });
          
            document.getElementById("loader1").style.visibility = "hidden";
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) { 
          var msg = JSON.parse( XMLHttpRequest.responseText);
          document.getElementById("loader1").style.visibility = "hidden";
        // alert("Status: " + textStatus); alert("Error: " + errorThrown); 
    },
    });
         var request;

$("#add_assignment_form").submit(function (event) {
// alert(document.getElementById("imagesuploadform").value);
    // Prevent default posting of form - put here to work in case of errors
    event.preventDefault();

    // Abort any pending request
    if (request) {
        request.abort();
    }
    // setup some local variables
    // var formData = new FormData(this);
    var aname = $("#aname").val();
    var question = document.getElementById("editor").innerHTML;
    var answer = $("#code-input").val();
    var cid = $("#cid").val();
    
    // var dateFormat= new Date();
    // formData.append("sender_id", user_ida);
    // msgarea
    // var messaga = document.getElementById("msgarea").value;
    // console.log(formData)
    document.getElementById("loader1").style.visibility = "visible";
    var data = JSON.stringify({
      aname:aname, question:question,answer:answer, cid: cid
  })
    $.ajax({
        type: "post",
        data: data,
        contentType: "application/json",
        url: `${baseurl}/add-assignment`,
        success: function (result) {
          Swal.fire({
                                  icon: 'success',
                                  title: 'Successful!',
                                  text: result.message,
                                  allowOutsideClick: false
                                })
                                $( 'button.swal2-confirm' ).click(function() {
                                  location.reload();
                                });
            document.getElementById("loader1").style.visibility = "hidden";
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) { 
          var msg = JSON.parse( XMLHttpRequest.responseText);
          Swal.fire({
                                  icon: 'error',
                                  title: 'Failed!',
                                  text: msg.message,
                                })

          document.getElementById("loader1").style.visibility = "hidden";
        // alert("Status: " + textStatus); alert("Error: " + errorThrown); 
    },
    });
});

// document.addEventListener('DOMContentLoaded', function () {
//     // Get the textarea element
//     const codeInput = document.getElementById('code-input');

//     // Add an event listener to the textarea to update the highlighting on input
//     codeInput.addEventListener('input', function () {
//         updateCodeHighlighting();
//     });

//     // Initial highlighting
//     updateCodeHighlighting();
// });

async function updateCodeHighlighting() {
    // Get the code from the textarea
    // console.log("hellow")
    const code = document.getElementById('code-input').value;
    // console.log(code)
    // try {
    //   document.getElementById("loader1").style.visibility = "visible";
    // $.ajax({
    //     type: "post",
    //     contentType: "application/json",
    //     data: JSON.stringify({
    //       code: code
    //     }),
    //     url: `${baseurl}/get-prettified-code`,
    //     success: function (result) {
    //                 console.log(result);
                    const highlightedCode = Prism.highlight(code, Prism.languages.java, 'java');

// Display the highlighted code
document.getElementById('prismcodehere1').innerHTML = highlightedCode;
            // document.getElementById("loader1").style.visibility = "hidden";
        // },
    //     error: function(XMLHttpRequest, textStatus, errorThrown) { 
    //       var msg = JSON.parse( XMLHttpRequest.responseText);
    //       // console.log(msg)
    //       if(msg.message == "Course not found"){
    //         document.getElementById("clist").innerHTML = msg.message;
    //       }
    //       document.getElementById("loader1").style.visibility = "hidden";
    //     // alert("Status: " + textStatus); alert("Error: " + errorThrown); 
    // },
    // })

      // Use Prism to highlight the code
    // const formattedCode = await formatJavaCode(code);

  // } catch (error) {
  //       console.error('Error formatting code:', error);
  //   }
}

// async function formatJavaCode(code) {
//       // Load the Google Java Format module
//       const formattedText = prettier.format(code, {
//       parser: "java",
//       tabWidth: 2
//     });
//       return formattedCode;
//     }
// const toolbarOptions = [
//   [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme
// ];

  quill = new Quill('#editor', {
  modules: {
    // toolbar: toolbarOptions
  },
    theme: 'snow'
  });
 </script>

 